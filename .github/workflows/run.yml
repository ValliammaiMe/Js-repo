name: Run JS Scripts Weekly

on:
  push:
    branches:
      - main
  workflow_dispatch:
  schedule:
    - cron: "0 17 * * 0"   # Runs weekly on Sunday at 17:00 UTC

jobs:
  run-node:
    runs-on: ubuntu-latest

    steps:
      # Pull repo code
      - name: Checkout repository
        uses: actions/checkout@v3

      # Set up Node.js v20
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      # Install dependencies only if package.json exists
      - name: Install dependencies
        run: |
          if [ -f package.json ]; then
            npm install
          else
            echo "No package.json found. Skipping npm install."
          fi

      # Run ALL JS files automatically
      - name: Run all JS scripts
        run: |
          echo "Executing all JS files in repository..."
          for file in *.js; do
            echo "-----------------------------------------"
            echo "Running: $file"
            node "$file"
          done
